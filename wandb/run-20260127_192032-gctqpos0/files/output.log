Epoch 1/50: 100%|████████████████████| 200/200 [14:16<00:00,  4.28s/it, loss=1.1602, lr=5.00e-06]
Evaluating: 100%|████████████████████████████████████████████████| 50/50 [00:59<00:00,  1.19s/it]
Saved best model at Epoch 1 to trained_models/best_model_epoch1.pt
Epoch 2/50: 100%|████████████████████| 200/200 [14:10<00:00,  4.25s/it, loss=0.9925, lr=1.00e-05]
Evaluating: 100%|████████████████████████████████████████████████| 50/50 [00:57<00:00,  1.16s/it]
Saved best model at Epoch 2 to trained_models/best_model_epoch2.pt
Epoch 3/50: 100%|████████████████████| 200/200 [14:48<00:00,  4.44s/it, loss=0.9087, lr=1.50e-05]
Evaluating: 100%|████████████████████████████████████████████████| 50/50 [00:50<00:00,  1.00s/it]
Saved best model at Epoch 3 to trained_models/best_model_epoch3.pt
Epoch 4/50: 100%|████████████████████| 200/200 [14:25<00:00,  4.33s/it, loss=0.6877, lr=2.00e-05]
Evaluating: 100%|████████████████████████████████████████████████| 50/50 [00:55<00:00,  1.11s/it]
Saved best model at Epoch 4 to trained_models/best_model_epoch4.pt
Epoch 5/50: 100%|████████████████████| 200/200 [14:14<00:00,  4.27s/it, loss=0.7796, lr=2.50e-05]
Evaluating: 100%|████████████████████████████████████████████████| 50/50 [00:55<00:00,  1.11s/it]
Epoch 6/50:  20%|████▎                | 41/200 [04:13<13:59,  5.28s/it, loss=0.7560, lr=2.60e-05]Exception ignored in: <function _MultiProcessingDataLoaderIter.__del__ at 0x10cc751c0>
Traceback (most recent call last):
  File "/Users/caolu/opt/anaconda3/envs/multi/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 1604, in __del__
    self._shutdown_workers()
  File "/Users/caolu/opt/anaconda3/envs/multi/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 1568, in _shutdown_workers
    w.join(timeout=_utils.MP_STATUS_CHECK_INTERVAL)
  File "/Users/caolu/opt/anaconda3/envs/multi/lib/python3.11/multiprocessing/process.py", line 149, in join
    res = self._popen.wait(timeout)
          ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/caolu/opt/anaconda3/envs/multi/lib/python3.11/multiprocessing/popen_fork.py", line 40, in wait
    if not wait([self.sentinel], timeout):
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/caolu/opt/anaconda3/envs/multi/lib/python3.11/multiprocessing/connection.py", line 948, in wait
    ready = selector.select(timeout)
            ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/caolu/opt/anaconda3/envs/multi/lib/python3.11/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt:
Epoch 6/50:  20%|████▎                | 41/200 [04:22<16:58,  6.40s/it, loss=0.7560, lr=2.60e-05]
Traceback (most recent call last):
  File "/Users/caolu/Desktop/AI_Lab5/main.py", line 120, in <module>
    val_accuracy = trainer.train(train_dataloader, valid_dataloader, config.epochs, evaluate_every=1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/caolu/Desktop/AI_Lab5/train_validate.py", line 125, in train
    loss.backward()
  File "/Users/caolu/opt/anaconda3/envs/multi/lib/python3.11/site-packages/torch/_tensor.py", line 581, in backward
    torch.autograd.backward(
  File "/Users/caolu/opt/anaconda3/envs/multi/lib/python3.11/site-packages/torch/autograd/__init__.py", line 347, in backward
    _engine_run_backward(
  File "/Users/caolu/opt/anaconda3/envs/multi/lib/python3.11/site-packages/torch/autograd/graph.py", line 825, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
