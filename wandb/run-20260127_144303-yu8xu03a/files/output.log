'(MaxRetryError("HTTPSConnectionPool(host='huggingface.co', port=443): Max retries exceeded with url: /openai/clip-vit-base-patch32/resolve/main/config.json (Caused by SSLError(SSLEOFError(8, '[SSL: UNEXPECTED_EOF_WHILE_READING] EOF occurred in violation of protocol (_ssl.c:1016)')))"), '(Request ID: 0dc69074-801c-4c40-a84c-70a091ac765c)')' thrown while requesting HEAD https://huggingface.co/openai/clip-vit-base-patch32/resolve/main/config.json
Retrying in 1s [Retry 1/5].
'(MaxRetryError("HTTPSConnectionPool(host='huggingface.co', port=443): Max retries exceeded with url: /openai/clip-vit-base-patch32/resolve/main/config.json (Caused by SSLError(SSLEOFError(8, '[SSL: UNEXPECTED_EOF_WHILE_READING] EOF occurred in violation of protocol (_ssl.c:1016)')))"), '(Request ID: eba5c9e9-b0f9-4da4-9803-48ce561f4434)')' thrown while requesting HEAD https://huggingface.co/openai/clip-vit-base-patch32/resolve/main/config.json
Retrying in 2s [Retry 2/5].
'(MaxRetryError("HTTPSConnectionPool(host='huggingface.co', port=443): Max retries exceeded with url: /openai/clip-vit-base-patch32/resolve/main/config.json (Caused by SSLError(SSLEOFError(8, '[SSL: UNEXPECTED_EOF_WHILE_READING] EOF occurred in violation of protocol (_ssl.c:1016)')))"), '(Request ID: f477f484-9040-4977-8f32-f5acaf409212)')' thrown while requesting HEAD https://huggingface.co/openai/clip-vit-base-patch32/resolve/main/config.json
Retrying in 4s [Retry 3/5].
 >>> Phase 1: Warming up Text. Gate is restricted.
Epoch 1/50: 100%|████████████████████| 200/200 [15:18<00:00,  4.59s/it, loss=1.1190, lr=5.00e-06]
Evaluating: 100%|████████████████████████████████████████████████| 50/50 [00:57<00:00,  1.16s/it]
Saved best model at Epoch 1 to trained_models/best_model_epoch1.pt
 >>> Phase 1: Warming up Text. Gate is restricted.
Epoch 2/50: 100%|████████████████████| 200/200 [13:41<00:00,  4.11s/it, loss=0.9757, lr=1.00e-05]
Evaluating: 100%|████████████████████████████████████████████████| 50/50 [00:54<00:00,  1.09s/it]
Saved best model at Epoch 2 to trained_models/best_model_epoch2.pt
 >>> Phase 1: Warming up Text. Gate is restricted.
Epoch 3/50: 100%|████████████████████| 200/200 [13:45<00:00,  4.13s/it, loss=0.9127, lr=1.50e-05]
Evaluating: 100%|████████████████████████████████████████████████| 50/50 [00:55<00:00,  1.12s/it]
Saved best model at Epoch 3 to trained_models/best_model_epoch3.pt
 >>> Phase 2: Unfreezing Gate and Image for Joint Learning
Epoch 4/50: 100%|████████████████████| 200/200 [14:43<00:00,  4.42s/it, loss=0.6885, lr=2.00e-05]
Evaluating: 100%|████████████████████████████████████████████████| 50/50 [00:57<00:00,  1.15s/it]
Saved best model at Epoch 4 to trained_models/best_model_epoch4.pt
Epoch 5/50: 100%|████████████████████| 200/200 [14:10<00:00,  4.25s/it, loss=0.7201, lr=2.50e-05]
Evaluating: 100%|████████████████████████████████████████████████| 50/50 [00:57<00:00,  1.15s/it]
Epoch 6/50: 100%|████████████████████| 200/200 [14:37<00:00,  4.39s/it, loss=0.7450, lr=3.00e-05]
Evaluating: 100%|████████████████████████████████████████████████| 50/50 [00:59<00:00,  1.19s/it]
Saved best model at Epoch 6 to trained_models/best_model_epoch6.pt
Epoch 7/50: 100%|████████████████████| 200/200 [15:09<00:00,  4.55s/it, loss=0.7133, lr=3.50e-05]
Evaluating: 100%|████████████████████████████████████████████████| 50/50 [00:55<00:00,  1.10s/it]
EarlyStopping counter: 1 out of 5
Epoch 8/50: 100%|████████████████████| 200/200 [14:51<00:00,  4.46s/it, loss=0.6560, lr=4.00e-05]
Evaluating: 100%|████████████████████████████████████████████████| 50/50 [01:00<00:00,  1.20s/it]
EarlyStopping counter: 2 out of 5
Epoch 9/50:   1%|▏                   | 2/200 [02:01<3:21:12, 60.97s/it, loss=0.6076, lr=4.01e-05]
Traceback (most recent call last):
  File "/Users/caolu/Desktop/AI_Lab5/main.py", line 120, in <module>
    val_accuracy = trainer.train(train_dataloader, valid_dataloader, config.epochs, evaluate_every=1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/caolu/Desktop/AI_Lab5/train_validate.py", line 125, in train
    loss.backward()
  File "/Users/caolu/opt/anaconda3/envs/multi/lib/python3.11/site-packages/torch/_tensor.py", line 581, in backward
    torch.autograd.backward(
  File "/Users/caolu/opt/anaconda3/envs/multi/lib/python3.11/site-packages/torch/autograd/__init__.py", line 347, in backward
    _engine_run_backward(
  File "/Users/caolu/opt/anaconda3/envs/multi/lib/python3.11/site-packages/torch/autograd/graph.py", line 825, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
